<?xml version="1.0" encoding="utf-8" ?>
<ContentView xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="SJMIT_Events.Views.Controls.Dashboard">

    <!-- Overlay for Sidebar -->
    <AbsoluteLayout ZIndex="1" IsVisible="True">
        <BoxView x:Name="DashboardOverlay"
                 BackgroundColor="#000000"
                 Opacity="0.4"
                 InputTransparent="False"
                 AbsoluteLayout.LayoutFlags="All"
                 AbsoluteLayout.LayoutBounds="1,0,1,1">
            <BoxView.GestureRecognizers>
                <TapGestureRecognizer Tapped="HideDashboard" />
            </BoxView.GestureRecognizers>
        </BoxView>

        <!-- Sidebar Menu -->
        <Frame x:Name="DashboardMenu"
               BackgroundColor="{AppThemeBinding Light=#FFFFFF, Dark=#1E1E1E}"
               HasShadow="False"
               CornerRadius="0"
               Padding="20"
               BorderColor="{AppThemeBinding Light=#E0E0E0, Dark=#333333}"
               AbsoluteLayout.LayoutFlags="HeightProportional"
               AbsoluteLayout.LayoutBounds="0,0,300,1">

            <ScrollView>
                <VerticalStackLayout Spacing="24">

                    <!-- Header -->
                    <VerticalStackLayout Spacing="4">
                        <Label Text="SJMIT Events"
                               FontSize="28"
                               FontAttributes="Bold"
                               TextColor="{AppThemeBinding Light=#1A1A1A, Dark=#F0F0F0}" />
                        <Label x:Name="CurrentDateLabel"
                               FontSize="14"
                               TextColor="{AppThemeBinding Light=#666666, Dark=#AAAAAA}" />
                    </VerticalStackLayout>

                    <!-- Enhanced Separator with gradient effect -->
                    <BoxView BackgroundColor="{AppThemeBinding Light=#E5E5E5, Dark=#444444}" 
                             HeightRequest="1" HorizontalOptions="Fill" Opacity="0.7"/>

                    <!-- Active Semester Card -->
                    <Border BackgroundColor="{AppThemeBinding Light=#F8F9FA, Dark=#242424}"
                            Stroke="{AppThemeBinding Light=#E0E0E0, Dark=#333333}"
                            StrokeThickness="1"
                            Padding="16">
                        <VerticalStackLayout Spacing="12">
                            <Label Text="Active Semester"
                                   FontSize="20"
                                   FontAttributes="Bold"
                                   TextColor="{AppThemeBinding Light=#2C2C2C, Dark=#E8E8E8}" />

                            <HorizontalStackLayout Spacing="35">
                                <VerticalStackLayout Spacing="4">
                                    <Label Text="Start Date" FontSize="14" TextColor="{AppThemeBinding Light=#555555, Dark=#CCCCCC}" />
                                    <Label Text="{Binding StartDate, StringFormat='{0:dd MMM yyyy}'}" FontSize="16" TextColor="{AppThemeBinding Light=#333333, Dark=#FFFFFF}" />
                                </VerticalStackLayout>

                                <VerticalStackLayout Spacing="4">
                                    <Label Text="End Date" FontSize="14" TextColor="{AppThemeBinding Light=#555555, Dark=#CCCCCC}" />
                                    <Label Text="{Binding EndDate, StringFormat='{0:dd MMM yyyy}'}" FontSize="16" TextColor="{AppThemeBinding Light=#333333, Dark=#FFFFFF}" />
                                </VerticalStackLayout>
                            </HorizontalStackLayout>
                        </VerticalStackLayout>
                    </Border>

                    <!-- Enhanced Separator with gradient effect -->
                    <BoxView BackgroundColor="{AppThemeBinding Light=#E5E5E5, Dark=#444444}" 
                             HeightRequest="1" HorizontalOptions="Fill" Opacity="0.7"/>


                    <Border x:Name="RefreshButton"
                            Stroke="{AppThemeBinding Light=#E0E0E0, Dark=#333333}" 
                            StrokeShape="RoundRectangle 12"
                            BackgroundColor="{AppThemeBinding Light=#F8F9FA, Dark=#242424}"
                            Padding="12,8">

                        <Grid ColumnDefinitions="*,Auto" VerticalOptions="Center">
                            <!-- Text aligned left -->
                            <Label Text="Refresh" 
                                   VerticalOptions="Center"
                                   FontSize="16" 
                                   FontAttributes="Bold"
                                   TextColor="{AppThemeBinding Light=#333333, Dark=#FFFFFF}" />

                            <!-- Icon aligned right -->
                            <Image Grid.Column="1" 
                                   Source="{AppThemeBinding Light='refresh_light.png', Dark='refresh_dark.png'}"
                                   HeightRequest="20" WidthRequest="20"
                                   VerticalOptions="Center" />
                        </Grid>

                        <!-- Tap handler -->
                        <Border.GestureRecognizers>
                            <TapGestureRecognizer Tapped="OnRefreshButtonTapped"/>
                        </Border.GestureRecognizers>
                    </Border>



                    <!-- Enhanced Separator with gradient effect -->
                    <BoxView BackgroundColor="{AppThemeBinding Light=#E5E5E5, Dark=#444444}" 
                             HeightRequest="1" HorizontalOptions="Fill" Opacity="0.7"/>

                    <!-- Filters -->
                    <VerticalStackLayout Spacing="12">
                        <Label Text="Filters"
                               FontSize="20"
                               FontAttributes="Bold"
                               TextColor="{AppThemeBinding Light=#2C2C2C, Dark=#E8E8E8}" />
                    </VerticalStackLayout>

                    <!-- Date Picker -->
                    <Border BackgroundColor="{AppThemeBinding Light=#F8F9FA, Dark=#242424}"
                            Stroke="{AppThemeBinding Light=#E0E0E0, Dark=#333333}"
                            StrokeShape="RoundRectangle 12"
                            StrokeThickness="1"
                            Padding="12, 2">
                        <HorizontalStackLayout Spacing="12" VerticalOptions="Center">
                            <Label Text="Date:" FontSize="16" FontAttributes="Bold" TextColor="{AppThemeBinding Light=#444444, Dark=#CCCCCC}" VerticalOptions="Center"/>
                            <DatePicker x:Name="EventDatePicker"
                                        FontSize="16"
                                        MinimumDate="{Binding StartDate, StringFormat='{0:dd MMM yyyy}'}"
                                        MaximumDate="{Binding EndDate, StringFormat='{0:dd MMM yyyy}'}"
                                        DateSelected="OnDatePickerDateSelected"
                                        TextColor="{AppThemeBinding Light=#333333, Dark=#FFFFFF}"
                                        VerticalOptions="Center"/>
                        </HorizontalStackLayout>
                    </Border>

                    <!-- Filters: 2 per row -->
                    <Grid ColumnSpacing="12" RowSpacing="12" RowDefinitions="*, *">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>

                        <!-- First Row -->
                        <Button x:Name="DayFilterBorder"
                                BackgroundColor="{AppThemeBinding Light=#F8F9FA, Dark=#242424}"
                               TextColor="{AppThemeBinding Light=#333333, Dark=#FFFFFF}" 
                               FontSize="16" FontAttributes="Bold" 
                               CornerRadius="12"
                               Padding="16,8"
                               Text="Day"
                               Grid.Row="0" Grid.Column="0"
                                  Clicked="OnViewFilterClicked" CommandParameter="Day"/>

                        <Button x:Name="WeekFilterBorder"
                               BackgroundColor="{AppThemeBinding Light=#F8F9FA, Dark=#242424}"
                               TextColor="{AppThemeBinding Light=#333333, Dark=#FFFFFF}" 
                               FontSize="16" FontAttributes="Bold" 
                               CornerRadius="12"
                               Padding="16,8"
                               Text="Week"
                               Grid.Row="0" Grid.Column="1" 
                                  Clicked="OnViewFilterClicked" CommandParameter="Week"/>

                        <Button x:Name="MonthFilterBorder"
                               BackgroundColor="{AppThemeBinding Light=#F8F9FA, Dark=#242424}"
                               TextColor="{AppThemeBinding Light=#333333, Dark=#FFFFFF}" 
                               FontSize="16" FontAttributes="Bold" 
                               CornerRadius="12"
                               Padding="16,8"
                               Text="Month"
                               Grid.Row="1" Grid.Column="0" 
                                  Clicked="OnViewFilterClicked" CommandParameter="Month"/>

                        <Button x:Name="AllFilterBorder"
                                BackgroundColor="{AppThemeBinding Light=#E3F2FD, Dark=#1565C0}"
                                TextColor="{AppThemeBinding Light=#333333, Dark=#FFFFFF}" 
                                FontSize="16" FontAttributes="Bold" 
                                CornerRadius="12"
                                Padding="14,8"
                                Text="All Events"
                                Grid.Row="1" Grid.Column="1" 
                                Clicked="OnViewFilterClicked" CommandParameter="All"/>
                    </Grid>

                </VerticalStackLayout>
            </ScrollView>
        </Frame>
    </AbsoluteLayout>
</ContentView>